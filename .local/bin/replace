#!/bin/sh
#
# Find and replace by a given list of files.
#
# replace foo bar **/*.rb

find_this="$1"
shift
replace_with="$1"
shift

if command -v rg &>/dev/null ; then
  items=$(rg -l --color never "$find_this" --fixed-strings --glob "$@")
else
  items=$(ag -l --nocolor "$find_this" "$@")
fi

IFS=$'\n'
for item in $items; do
  echo "Processing: $item"
  sed --in-place "s/$find_this/$replace_with/g" "$item"
done
